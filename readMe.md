# README: Развертывание Backend-Server для Уроков

## Описание проекта
Данный проект представляет собой веб-сервер на базе ExpressJS, который работает с данными по занятиям. Данные хранятся в СУБД PostgreSQL. Сервер предоставляет REST API для получения информации о занятиях, учителях и учениках. Веб-сервер разработан на TypeScript, взаимодействует с базой данных через Sequelize и поддерживает различные фильтрации для получения данных.

## Структура проекта
- **src/**: Основная директория с исходным кодом
  - **controllers/**: Логика обработки запросов и взаимодействие с моделями
  - **models/**: Описание моделей Sequelize для работы с базой данных
  - **routes/**: Определение маршрутов для Express
  - **interfaces/**: Определение интерфейсов TypeScript
  - **config/**: Конфигурационные файлы, такие как настройки базы данных
  - **utils/**: Утилитарные модули (например, логгер)
- **.env**: Файл с переменными окружения (не включен в репозиторий, создается вручную)
- **package.json**: Описание проекта, зависимости и команды для npm
- **README.md**: Документация по развертыванию и использованию проекта

## Предварительные требования
Перед началом установки убедитесь, что у вас установлены следующие программы:
- **Node.js** версии 16 или выше
- **npm** или **yarn**
- **PostgreSQL**

Также необходимо настроить базу данных PostgreSQL. Скачайте и разверните дамп данных по следующей ссылке: [Yandex Disk - lessons_db](https://disk.yandex.ru/d/dtr3sxsuceMfCw).

## Установка и Развертывание
Следуйте этим шагам, чтобы развернуть проект на вашем локальном компьютере.

### Шаг 1: Клонирование репозитория
Склонируйте репозиторий на ваш локальный компьютер:
```bash
$ git clone <URL вашего репозитория>
$ cd backend-lesson-app
```

### Шаг 2: Установка зависимостей
Установите все необходимые зависимости проекта с помощью npm или yarn:
```bash
$ npm install
```
или
```bash
$ yarn install
```

### Шаг 3: Настройка переменных окружения
Создайте файл `.env` в корневой директории проекта и добавьте туда следующие переменные окружения:
```
DATABASE_URL=postgres://postgres:admin@localhost:5432/lessons_db
PORT=3000
```
Отредактируйте переменные окружения в соответствии с вашей настройкой базы данных.

### Шаг 4: Настройка базы данных
Убедитесь, что база данных PostgreSQL запущена и доступна. Создайте базу данных с названием, указанным в `.env` (например, `lessons_db`). Затем разверните тестовые данные из дампа:
```bash
$ psql -U postgres -h localhost -p 5432 -d lessons_db < путь/к/файлу/дампа.sql
```

### Шаг 5: Компиляция TypeScript
Проект написан на TypeScript, поэтому необходимо скомпилировать его в JavaScript перед запуском.
```bash
$ npx tsc
```

### Шаг 6: Запуск сервера
После компиляции запустите сервер:
```bash
$ npm start
```
После успешного запуска, сервер будет доступен по адресу: `http://localhost:3000`.

### Шаг 7: Тестирование API
API сервера предоставляет доступ к данным по занятиям. Основной маршрут для взаимодействия — `/api/v1/lessons`.

Пример запроса:
```bash
$ curl -X GET "http://localhost:3000/api/v1/lessons"
```
Вы можете использовать Postman или другой инструмент для тестирования HTTP-запросов, чтобы протестировать API и проверить его работу.

## Основные маршруты API
- **GET /api/v1/lessons**: Получение списка занятий. Поддерживает параметры фильтрации (date, status, teacherIds, studentsCount, page, lessonsPerPage).

## Важные пояснения
- **Фильтрация и Пагинация**: Маршрут `/api/v1/lessons` поддерживает фильтрацию по дате, статусу занятия, ID учителей, количеству учеников и пагинацию.
- **Валидация**: Сервер выполняет валидацию входных данных, возвращая ошибку 400 при некорректных параметрах запроса.
- **Логирование**: В проекте используется кастомный логгер для логирования ошибок и информации о выполнении запросов.

## Команды для разработки
- **Запуск сервера в режиме разработки** (с автоматической перезагрузкой при изменениях):
```bash
$ npm run dev
```
- **Компиляция TypeScript**:
```bash
$ npx tsc
```
- **Запуск линтера**:
```bash
$ npm run lint
```

## Возможные проблемы
1. **Ошибка подключения к базе данных**: Проверьте, что PostgreSQL запущен, и параметры в `.env` файле корректно настроены.
2. **Ошибка компиляции TypeScript**: Убедитесь, что все типы и зависимости установлены корректно.

## Заключение
После выполнения всех шагов, ваш сервер должен быть успешно развернут и готов к работе. Не забудьте протестировать все API и убедиться в корректной работе всех фильтров и пагинации.

Если у вас возникнут какие-либо проблемы или вопросы, пожалуйста, обращайтесь в систему контроля версий, используя Issues или Pull Requests.

